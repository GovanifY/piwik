{{ postEvent("Template.beforeTopBar", userAlias, userLogin, topMenu, userMenu) }}
<div id="topLeftBar">

    {% macro menuItemLabel(label) %}
        {% if label starts with 'plugins/' and label ends with '.png' and '..' not in label %}
            <img src="{{ label }}"/>
        {% elseif label starts with 'icon-' %}
            <span class="{{ label }}"/>
        {% else %}
            {{ label|translate }}
        {% endif %}
    {% endmacro %}

    {% macro topMenuItem(label, menu, currentModule, currentAction) %}
        {% if menu._html is defined %}
            {{ menu._html|raw }}
        {% elseif (menu._url.module == currentModule and (menu._url.action is empty or menu._url.action == currentAction)) %}
            <span class="topBarElem topBarElemActive"><strong>{{ _self.menuItemLabel(label) }}</strong></span>
        {% else %}
            <span class="topBarElem" {% if menu._tooltip is defined %}title="{{ menu._tooltip }}"{% endif %}>
        <a id="topmenu-{{ menu._url.module|lower }}" href="index.php{{ menu._url|urlRewriteWithParameters }}">{{ _self.menuItemLabel(label) }}</a>
    </span>
        {% endif %}
    {% endmacro %}

    {% macro userMenuItem(label, menu, currentModule, currentAction) %}

        <a class="item {% if (menu._url.module == currentModule and (menu._url.action is empty or menu._url.action == currentAction)) %}active{% endif %}"
           href="index.php{{ menu._url|urlRewriteWithParameters }}"
           id="usermenu-{{ menu._url.module|lower }}-{{ menu._url.action|default('index')|lower }}"
           {% if menu._tooltip is defined %}title="{{ menu._tooltip }}"{% endif %}
                >{{ label|translate }}</a>

    {% endmacro %}

    {% if topMenuModule is not defined %}
        {% set topMenuModule = currentModule %}
        {% set topMenuAction = currentAction %}
    {% endif %}

    {% spaceless %}
        {% for label,menu in topMenu if menu._order < 900 %}
            {{ _self.topMenuItem(label, menu, topMenuModule, topMenuAction) }}
        {% endfor %}
    {% endspaceless %}

</div>

<div id="topRightBar">
    {% spaceless %}
        {% for label,menu in topMenu if menu._order >= 900 %}
            {{ _self.topMenuItem(label, menu, topMenuModule, topMenuAction) }}
        {% endfor %}
    {% endspaceless %}
</div>
